# 02. 객체들에게 연락 돌리기 - 옵저버 패턴

- 뭔가 재미있는 일이 생겼을 때 모르고 지나치면 슬프겠죠?
  - 뭔가 중요한 일이 일어났을 때 객체에게 새 소식을 알려줄 수 있는 패턴 => 옵저버 패턴
- 옵저버 패턴

  - 자주 사용되는 패턴! 엄청나게 쓸모 있음!
  - 1:N 관계?
  - 느슨한 결합?

- 이번장 컨셉
  - Weather-O-Rama(회사)의 차세대 `인터넷 기반 기상 스테이션 구축` 프로젝트
- 업무 계약 체결서
  - 차세대 인터넷 기반 기상 스테이션 구축 프로젝트
  - 기상 스테이션
    - WeatherData 객체를 바탕으로 만들어질 예정
    - 이 객체를 바탕으로 3개 항목을 화면에 표시하는 애플리케이션을 만들어주세요
    - 화면에 표시할 3개 항목
      - 현재 조건
      - 기상 통계
      - 기상 예보
    - 위 항목들은 모두 WeatherData 객체에서 최신 측정치를 수집할 때 마다 실시간으로 갱신 됨
  - 확장 가능해야 함 - 다른 개발자가 직접 날씨 디스플레이를 만들어서 넣을 수 있어야 함

## 기상 모니터링 애플리케이션 알아보기

- 만들거나 확장해야 하는 부분을 전부 파악하기
  - 기상 스테이션 : 실제 기상 정보를 수집하는 물리 장비 - 습도센서, 온도센서, 기압센서
  - WeatherData 객체 : 기상 스테이션으로 부터 오는 정보를 추적하는 객체
    - WeatherData 객체와 디스플레이를 통합하는 작업도 함
  - 사용자에게 현재 기상 조건을 보여주는 디스플레이 장비
    - 현재 조건, 기상 통계, 기상 예보 중에서 원하는 내용을 선택해서 표시할 수 있음

## WeatherData 클래스 살펴보기

```ts
class WeatherData {
  getTemperature() {
    // ...
  }
  getHumidity() {
    // ...
  }
  getPressure() {
    // ...
  }
  measurementsChanged() {
    //...
  }
}
```

- 가장 최근에 측정된 온도, 습도, 기압 값을 리턴하는 메소드
- 기상 스테이션에서 갱신된 정보를 가져오는 일은 WeatherData객체가 알아서 해줌
- 갱신된 값을 가져올 때마다 measurementsChanged() 메소드가 호출된다

## 구현 목표

- WeatherData 클래스에서는 3가지 측정값(온도, 습도, 기압)의 게터 메소드가 있다
- 새로운 기상 측정 데이터가 들어올 때 마다 measurementsChanged() 메소드가 호출된다
- 기상 데이터를 사용하는 디스플레이 요소 3가지를 구현해야 한다
  - 현재 조건 디스플레이
    - 온도
    - 습도
    - 기압
  - 기상 통계 디스플레이
    - 평균 기운
    - 최저 기온
    - 최고 기온
  - 기상 예보 디스플레이
    - (기상 예보)
- 디스플레이를 업데이트하도록 measurementsChanged() 메소드에 코드를 추가해야 한다

### 추가 목표

- 미래를 생각해보자(확장 가능성, 변화)
- 확장성
  - 디스플레이 요소를 더하거나 뺄 수 있게 해주는 것

## 기상 스테이션용 코드 추가하기

- 쓰면서 제대로 공부하기
  - 현재까지 코드 설명
    - 인터페이스가 아닌 구체적인 구현을 바탕으로 코딩
    - 새로운 디스플레이 항목이 추가될 때마다 코드를 변경해야 함
    - 실행 중에 디스플레이 항목을 추가하거나 제거할 수 없음
    - 바뀌는 부분을 캡슐화하지 않음

## 원칙적으로 추가 코드 살펴보기

```ts
class WeatherData {
  // ...

  measurementsChanged() {
    const temp = this.getTemperature();
    const humidity = this.getHumidity();
    const pressure = this.getPressure();

    // 구체적인 구현에 맞춰서 코딩했으므로 디스플레이 항목을 추가하거나 제거할 수 없음
    this.conditionDisplay.update(temp, humidity, pressure); // 바뀔 수 있는 부분 => 캡슐화 필요
    this.statisticsDisplay.update(temp, humidity, pressure); // 바뀔 수 있는 부분 => 캡슐화 필요
    this.forecastDisplay.update(temp, humidity, pressure); // 바뀔 수 있는 부분 => 캡슐화 필요
  }
}
```

- 실행 중에 디스플레이를 더하거나 빼려면 어떻게 해야 할까요?
- update() 메소드를 공통적으로 가지고 있는 것으로 봐서 공통된 인터페이스를 사용하고 있는 것 같네요

- 2장 제목인 옵저버 패턴을 먼저 알아본 다음 모니터링 애플리케이션에 적용해봅시다 !
