# 13. 실전 디자인 패턴 - 패턴과 행복하게 살아가기

- 현실에서 복잡한 문제를 해결 하기 위해 실전을 대비하는 가이드를 살펴보자

## 디자인 패턴과 함께하는 행복한 삶을 위한 객체마을 공식 가이드

- 널리 퍼져 있는 '디자인 패턴'의 정의에 관한 오해를 확실하게 풀고 갑시다
- 디자인 패턴 카탈로그를 알아보고, 그 필요성을 제대로 파악합시다
- 적절한 시점에 디자인 패턴을 사용합시다
- 패턴을 제 범주에 맞게 사용합시다
- 패턴 발견은 고수만이 할 수 있는 일은 아닙니다
  - 간단한 설명을 읽고 나면 여러분도 패턴을 발견할 수 있습니다
- 베일에 싸여 있던 4인방(GoF, Gang of Four)의 실체가 드러납니다. 놓치지 마세요!
- 대세를 따릅시다
- 패턴을 사용하는 사람이라면 반드시 가지고 있어야 하는 책을 소개 합니다
- 스승님으로부터 정신 수양법을 배웁시다
- 패턴과 관련된 다양한 용어를 많이 익혀서 친구들과 다른 개발자들에게 깊은 인상을 심어줍시다

## 디자인 패턴의 정의

> 패턴(Pattern)은 특정 컨텍스트 내에서 주어진 문제의 해결책이다

- 컨텍스트(context)란 패턴이 적용되는 상황을 뜻합니다
  - 반복적으로 일어날 수 있는 상황이어야만 합니다
- 문제(problem)란 컨텍스트 내에서 이뤄야 하는 목표를 뜻합니다
  - 여기에는 컨텍스트 내의 제약조건도 포함됩니다
- 해결책(solution)은 바로 우리가 찾아내야 하는 것입니다

  - 제약조건 속에서 누가 적용해도 목표를 이룰 수 있는 일반적인 디자인을 뜻합니다

- e.g.

  - 컨텍스트 : 객체들의 컬렉션이 주어져 있습니다
  - 문제 : 컬렉션의 구현을 드러내지 않으면서 그 안에 있는 각 객체를 대상으로 순환 작업을 할 수 있어야 합니다
  - 해결책 : 반복 작업을 별도의 클래스로 캡슐화합니다(Iterator 패턴)

- 어떤 컨텍스트 내에서 일련의 제약조건에 의해 영향을 받는 문제가 발생했다면,
  그 제약조건 내에서 목적을 달성하기 위한 해결책이 되는 디자인을 적용하면 된다

- 패턴을 정의할 수 있어야 다양한 장점을 제공하는 패턴 카탈로그를 만들 수 있습니다

- 디자인 패턴의 정의에 사용된 용어 예시2
  - 문제 : 어떻게 회사에 제시간에 도착할 것인가?
  - 컨텍스트 : 차에 자동차 열쇠를 두고 나왔는데 문이 잠겼다
  - 해결책 : 유리를 깬다. 차에 들어간다. 차를 몰고 출근한다.
  - 이걸 패턴이라고 할 수 있을까요?
    - 패턴은 반복적으로 등장하는 문제에 적용할 수 있어야 한다
    - 차유리를 깨는 방법은 반복적으로 적용할 수 있는 해결책이 아닙니다
    - 이런 해결 책을 다른 사람에게 알려줘서 그 사람이 처한 문제의 해결책으로 적용하게 하기가 힘들다
    - 패턴의 특징을 위배
      - 패턴에 이름을 붙이지 않았다
        - 이름이 없다면 다른 개발자들과 그 패턴에 관한 토론을 하기가 정말 어려울 것입니다

## 디자인 패턴의 정의 자세히 살펴보기

- 반복적으로 등장하는 문제에 적용할 수 있는 해결책이다
- 패턴을 기술하고 패턴 카탈로그에 수록할 때 사용하는 방법들에 대해 알아보자

## 무엇이든 물어보세요

- Q1) 그럼, 이제 문제, 컨텍스트, 해결책 형태로 기술된 패턴을 살펴보는 건가요?
- A1) 패턴 카탈로그에서 볼 수 있는 패턴 설명은 보통 좀 더 자세하게 적혀 있습니다

  - 패턴 카탈로그에는 패턴의 용도와 패턴이 만들어진 배경, 적용할 수 있는 범위, 해결책의 디자인 및 그 해결책을 적용한 결과(장단점)와 같은 다양한 내용이 자세히 적혀 있습니다

- Q2) 패턴의 구조를 조금 변경해서 제가 사용하는 디자인에 맞게 써도 되나요? 아니면 정의를 있는 그대로 따라야 하나요?
- A2) 물론 디자인에 맞게 바꿔도 됩니다. 디자인 원칙과 마찬가지로 디자인 패턴도 법칙이나 규칙이 아닌 지침 정도라고 생각하면 됩니다.

  - 필요에 따라 적당히 고쳐서 써도 되죠. 실전에서 패턴이 적용되는 예를 보면 고전적인 패턴 디자인과 다른 부분도 많이 있습니다
  - 하지만 패턴을 바꿔서 사용할 때, 고전적인 디자인과 어떻게 다른지를 문서화해 놓으면 여러 모로 좋습니다.
  - 다른 개발자가 여러분이 사용하고 있는 패턴을 빠르게 파악하고, 여러분이 사용한 패턴과 고전적인 패턴 사이의 차이점을 이해하는 데 큰 도움이 될 거니까요

- Q3) 패턴 카탈로그는 어디서 구할 수 있나요?
- A3) 가장 훌륭한 패턴 카탈로그로 'GoF의 디자인 패턴'을 들 수 있습니다.
  - 이 카탈로그에는 23개의 기본 패턴이 수록되어 있습니다.
  - 그 밖에도 엔터프라이즈 소프트웨어, 컨커런트 시스템, 비즈니스 시스템 등과 같은 다양한 영역에 맞는 패턴 카탈로그들이 출시되고 있습니다

## 코딩 심화학습

- 포스 : 문제 = 목적 + 제약조건

### GoF 책 구성

- 패턴 이름
- 패턴의 종류 또는 범주
- Intent(용도)
  - 패턴의 역할이 기술됩니다
- Motivation(동기)
  - 문제를 기술하고 주어진 해결책이 어떤 식으로 그 문제를 해결하는지 보여주는 구체적인 시나리오
- Applicability(적용 대상)
  - 그 패턴을 적용할 수 있는 상황
- Structure(구조)
  - 이 패턴에서 쓰이는 클래스들의 관계를 보여주는 다이어그램이 수록
- Participants(구성 요소)
  - 클래스와 객체들의 설명이 들어있습니다
  - 패턴 내에서 각 클래스(객체)가 맡는 임무와 역할을 설명합니다
- Collaboration(협동)
  - 각 구성요소(participant)가 패턴 내에서 어떤 식으로 서로 도움을 주는지 설명되어 있습니다
- Consequences(결과)
  - 이 패턴을 사용했을 때의 효과(장점과 단점)가 수록됩니다
- Implementation(구현)
  - 패턴을 구현할 때 필요한 기술과 주의사항
- Sample Code(예제 코드)
  - 구현하는 데 도움이 될 만한 코드를 제공합니다
- Known Uses(사용 사례)
  - 실제 시스템에서 이 패턴을 사용하는 예시 설명이 들어 있습니다
- Related Patterns(관련 패턴)
  - 이 패턴과 다른 패턴 사이의 관계를 설명하는 내용이 나와 있습니다

## 무엇이든 물어보세요

- Q1) 평범한 사람도 디자인 패턴을 새로 만들 수도 있나요?
- A1) 우선 패턴은 만들어지는 것이 아니라 발견되는 것이라는 사실을 꼭 기억하세요

  - 자신이 발견한 디자인 패턴을 제대로 설명할 수만 있다면 누구나 발견했다고 말할 수 있죠
  - 하지만 그리 쉬운 일은 아닙니다
  - 금세 발견되지도 않고, 자주 발견하기도 힘들죠
  - '패턴 작가'가 되려면 상당한 노력이 필요합니다
  - 우선 왜 패턴을 찾으려고 하는지, 왜 패턴을 저술하려고 하는지를 생각해봐야 합니다
  - 대부분의 사람은 굳이 새로운 패턴을 정립하려고 하지 않고 그냥 사용하기만 하니까요
  - 하지만 특화된 분야에서 일을 하다보면 유용한 패턴을 새로 발견하는 경우도 있고, 자주 발생하는 문제의 일반적인 해결책을 찾아내는 경우도 있습니다
  - 아니면 패턴 커뮤니티에 깊이 빠져 지내다가 도움이 될 만한 뭔가를 깨달을 수도 있습니다

- Q2) 저도 패턴을 발견하고 싶어요. 어디서부터 시작하면 좋죠?
- A2) 어느 분야나 다 그렇지만, 이 바닥에서도 아는 게 힘입니다

  - 기존 패턴을 열심히 파헤쳐 보고, 무엇을 하는 패턴인지, 그 패턴이 다른 패턴과 어떤 관계를 가지는지를 확실히 이해해야 합니다
  - 그러다 보면 패턴 형성 과정을 잘 알 수 있게 되고, 이미 정립되어 있는 패턴을 새로 만드느라 고생하는 일도 방지할 수 있죠
  - 그런 준비가 다 끝났다면 여러분이 발견한 패턴을 문서화하고 다른 개발자들과 토론할 수 있씁니다
  - 패턴 토론이 무엇인지는 잠시 후에 더 자세히 알아보죠
  - 정말 관심이 있다면 다음 쪽에 있는 내용을 자세하게 읽어 보세요

- Q3) 정말 새로운 패턴을 발견했는지 어떻게 알 수 있을까요?
- A3) 아주 좋은 질문입니다. 다른 사람들이 사용해보고 정말 유용하다는 결론을 내리기 전까지는 패턴으로 인정을 받을 수 없습니다
  - 일반적으로 패턴으로 인정받으려면 실전에서 등장하는 문제의 해결책으로 3번 이상 적용되어야만 한다는 의미의 '3의 규칙(Rule of Three)'을 통과하기 전에는 패턴이라고 할 수 없죠

## 새로운 디자인 패턴 발견하기

- 숙제를 먼저 합시다

  - 새로운 패턴을 만들기 전에 기존 패턴을 확실하게 파악해야 합니다
  - 새로워 보이는 패턴도 잘 따져 보면 기존 패턴을 변형한 것에 불과한 경우가 대부분이거든요
  - 패턴을 열심히 공부하다 보면 패턴을 알아보는 눈이 길러지고, 다른 패턴과 연관 짓는 능력도 발달합니다

- 오랜 시간에 걸쳐서 심사숙고해 보세요

  - 패턴에 관한 아이디어는 여러분의 경험(여러분이 접해 본 문제와 사용했던 해겱책)에서 나옵니다
  - 지금까지의 경험을 토대로 다시 한번 곰곰이 생각해 보고, 반복적으로 발생하는 문제를 해결할 수 있는 새로운 디자인이 되도록 다듬어야 합니다
  - 완전히 새로운 패턴이라고 생각되는 것도 기존 패턴을 변형한 것에 불과할 수 있다는 사실을 기억하세요
  - 새로운 패턴을 발견했다고 생각했는데 적용 범위가 너무 좁아서 진짜 패턴이라고 하기 힘든 것도 많으니까요

- 머릿속에 들어있는 아이디어를 남들도 이해할 수 있도록 종이 위에 적어 보세요

  - 여러분이 발견한 것을 남들이 활용할 수 없다면 새로운 패턴을 발견한 의미가 전혀 없겠죠?
  - 새로운 패턴을 발견한 것 같다면, 다른 사람들이 직접 적용해 보고 피드백을 제공할 수 있도록 문서로 만들어 보세요
  - 패턴을 문서화하는 방법은 고민하지 않아도 됩니다. 이미 GoF템플릿이 어떻게 생겼는지 알고 있잖아요.
  - 패턴의 특성을 설명하는 방법은 이미 마련되어 있으니까, 그 문서 형식을 그대로 활용해서 여러분이 발견한 패턴을 문서로 작성하기만 하면 됩니다

- 새로운 패턴을 다른 사람들이 사용하게 해서, 계속 다듬어 보세요

  - 패턴을 한 번에 오나성하긴 힘듭니다. 새로운 패턴은 시간이 지남에 따라 점점 더 나아진다고 생각하세요.
  - 다른 개발자들에게 여러분이 발견한 패턴을 시험해 볼 기회를 제공하고, 피드백을 얻어 보세요. 그리고 패턴을 설명하는 문서에 피드백을 반영하고, 다시 검증을 받는 과정을 여러 번 반복하세요.
  - 완벽하게 만들기는 불가능하겠지만, 계속 고치다 보면 다른 개발자들이 읽고 이해하는 데 부족함이 없는 패턴 문서를 만들 수 있습니다

- 3의 규칙을 잊지 마세요
  - 패턴이 실전 문제 해결에 3번 이상 적용되어야 패턴 자격을 얻을 수 있다는 점을 절대 잊지 마세요
  - 이 이유 때문에라도 다른 사람들에게 새로운 패턴을 테스트할 기회를 제공해야 합니다
  - 그 과정에서 점점 더 제대로 된 패턴에 가까워지죠

## 누가 무엇을 할까요?

- 패턴과 올바른 설명을 연결해 보세요
- 데코레이터 패턴
  - 객체를 감싸서 새로운 행동을 제공합니다
- 상태 패턴
  - 상태를 기반으로 하는 행동을 캡슐화한 다음 위임으로 필요한 행동을 선택합니다
- 반복자 패턴
  - 컬렉션이 어떤 식으로 구현되었는지 드러내지 않으면서도 컬렉션 내에 있는 모든 객체를 대상으로 반복 작업을 처리할 수 있게 해 줍니다
- 퍼사드 패턴
  - 일련의 클래스에 간단한 인터페이스를 제공합니다
- 전략 패턴
  - 교환 가능한 행동을 캡슐화하고 위임으로 어떤 행동을 사용할지 결정합니다
- 프록시 패턴
  - 객체를 감싸서 그 객체로의 접근을 제어합니다
- 팩토리 메소드 패턴
  - 서브클래스에서 생성할 구상 클래스를 결정합니다
- 어댑터 패턴
  - 객체를 감싸서 다른 인터페이스를 제공합니다
- 옵저버 패턴
  - 상태가 변경되면 다른 객체들에게 연락을 돌릴 수 있게 해 줍니다
- 템플릿 메소드 패턴
  - 알고리즘 개별 단계를 구현하는 방법을 서브 클래스에서 결정합니다
- 컴포지트 패턴
  - 클라이언트에서 객체 컬렉션과 개별 객체를 똑같이 다룰 수 있도록 해 줍니다
- 싱글턴 패턴
  - 딱 한 객체만 생성되도록 합니다
- 추상 팩토리 패턴
  - 클라이언트에서 구상 클래스를 지정하지 않으면서도 객체군을 생성할 수 있도록 해 줍니다
- 커맨드 패턴
  - 요청을 객체로 감쌉니다

## 디자인 패턴 분류하기 ~ 디자인 패턴 범주 알아보기

- 점점 더 많은 디지안 패턴이 발견됨에 따라 디자인 패턴을 찾거나 같은 그룹에 속하는 패턴 끼리 비교하기 좋게, 종류에 따라 분류할 필요성이 생겼습니다
- 대부분의 카탈로그에서는 몇 가지 범주에 맞춰서 디자인 패턴을 분류하고 있습니다
- 그중 제일 유명한 분류 방법은 맨 처음 출간되었던 패턴 카탈로그에서 제시한 생성, 행동, 구조라는 3가지 범주로 용도에 따라 나누기입니다

### 생성 패턴(Creational Pattern)

- 객체 인스턴스를 생성하는 패턴으로, 클라이언트와 그 클라이언트가 생성해야 하는 객체 인스턴스 사이의 연결을 끊어 주는 패턴입니다
- 종류
  - 팩토리 메소드 패턴
  - 추상 팩토리 패턴
  - 싱글턴 패턴
  - 빌더 패턴
  - 프로토타입 패턴

### 행동 패턴(Behavioral Pattern)

- 클래스와 객체들이 상호작용하는 방법과 역할을 분담하는 방법을 다루는 패턴입니다
  - 객체나 클래스 사이의 알고리즘이나 책임 분배에 관련된 패턴입니다
- 종류
  - 인터프리터 패턴
  - 반복자 패턴
  - 중재자 패턴
  - 메멘토 패턴
  - 옵저버 패턴
  - 상태 패턴
  - 전략 패턴
  - 템플릿 메소드 패턴
  - 방문자(비지터) 패턴

### 구조 패턴(Structural Pattern)

- 클래스와 객체를 더 큰 구조로 만들 수 있게 구상을 사용하는 패턴입니다
  - 클래스나 객체를 조합해 더 큰 구조를 만드는 패턴입니다
- 종류
  - 어댑터 패턴
  - 브리지 패턴
  - 컴포지트 패턴
  - 데코레이터 패턴
  - 퍼사드 패턴
  - 플라이웨이트 패턴
  - 프록시 패턴

## 클래스를 다루는 패턴인지 객체를 다루는 패턴인지에 따라 분류

### 클래스(Class Patterns)

> 클래스 사이의 관계가 상속으로 어떻게 정의되는지를 다룹니다. 클래스 사이의 관계는 대부분 컴파일할 때 결정됩니다.

- 템플릿 메소드
- 팩토리 메소드
- 인터프리터
- 어댑터

### 객체(Object Patterns)

> 객체 사이의 관계를 다루며, 객체 사이의 관계는 보통 구성으로 정의됩니다. 일반적으로 실행 중에 관계가 결정되므로 보다 동적이고 유연합니다.

- 비지터
- 컴포지트
- 데코레이터
- 퍼사드
- 커맨드
- 반복자
- 프록시
- 책임연쇄
- 옵저버
- 메멘토
- 전략
- 중재자
- 상태
- 브리지
- 플라워웨이트
- 프로토타입
- 추상 팩토리
- 싱글턴

## 무엇이든 물어보세요

- Q1) 여기 나와 있는 것 말고 다른 분류 방법은 없나요?
- A1) 다른 분류 방법도 있습니다. 앞쪽에 있는 생성, 구조, 행동 이렇게 3가지 범주로 일단 나눈 다음 '분리 패턴(Decoupling Pattern)'과 같은 식으로 하위 범주로 다시 나누기도 하죠

  - 가장 많이 쓰이는 분류 방법에 익숙해 지는 게 좋긴 하겠지만, 패턴을 더 잘 이해하는 데 도움이 된다면 여러분 나름대로의 기준을 가지고 분류해도 좋습니다

- Q2) 패턴을 범주별로 나누는 게 패턴을 외우는 데 도움이 되나요?
- A2) 패턴을 비교하는 데 도움ㅇ이 되는 건 확실합니다. 하지만 생성, 구조, 행동 이렇게 3가지 범주로 나누기를 어려워하는 사람도 많습니다.

  - 꼭 한 범주에 속한다고 보기 어려운 경우가 종종 있으니까요
  - 패턴 분류보다 더 중요한 일은 패턴을제대로 이해하고, 여러 패턴 사이의 관계를 확실히 파악하는 일입니다
  - 범주를 기준으로 분류하는 게 도움이 된다면 적극적으로 활용하는 게 좋겠죠?

- Q3) 데코레이터 패턴이 왜 구조 패턴에 들어가 있죠?
  - 제 생각에는 행동 패턴이 맞을 것 같은데요? 행동을 추가하는 패턴이잖아요
- A3) 많은 개발자가 데코레이터 패턴을 행동 패턴에 넣어야 한다고 생각합니다
  - GoF의 패턴 책에서 그렇게 분류해 놓은 이유를 설명하자면,
    - 구조 패턴은 클래스와 객체가 새로운 구조와 기능을 만들려고 클래스와 객체를 구성하는 방법이라고 정의합니다
  - 데코레이터 패턴은 한 객체를 다른 객체로 감싸서 새로운 기능을 제공해 주는 패턴입니다
  - 따라서 행동 패턴의 용도인 객체 사이의 통신과 상호연결보다는 객체들을 동적으로 구성해서 새로운 기능을 얻는 쪽에 초점을 맞춰야 할 것입니다
  - 어느 쪽에 중점을 둬야 할지를 결정하는 게 그리 간단하지 않은 데다가, 데코레이터(구조 패턴)와 프록시 패턴(행동 패턴)이 상당히 유사하므로 분류하기가 더 어렵습니다.
  - 하지만 두 패턴의 용도가 다르다는 점을 꼭 기억해 주세요.
  - 패턴의 용도는 패턴을 분류하는 데 있어서 가장 핵심적인 부분이니까요

## 스승과 제자

- 패턴을 범주로 분류하면, 큰 틀에서 비교할 수 있다
  - e.g.
    - 일단 생성 패턴이 필요하다는 사실을 알고 있다면 구체적으로 어떤 패턴이 필요한지 몰라도 생성 패턴 자체를 얘기해 볼 수는 있다
- 범주 내에서 항목을 비교하는 데도 도움이 됩니다
- 3가지 범주로 나눈 것은 사람들이 3가지로 나누는 걸 좋아해서 이기도 하다
  - 실제로 4가지, 5가지 범주로 나누자고 주장한 사람들도 있다

## 패턴으로 생각하기

- 이론을 많이 알고 있어도 경험과 연습 없이는 별로 도움이 되질 못합니다
- 패턴으로 생각하는 데 도움이 될 만한 내용을 몇 가지 정리해보자

### 최대한 단순하게

- 디자인을 할 때 무엇보다도 중요한 원칙은 최대한 단순한 방법(KISS, Keep it Simple)으로 문제를 해결하기 입니다
- 이 문제에 어떻게 패턴을 적용할 수 있을까? 가 아니라 "어떻게 하면 단순하게 해결할 수 있을까?"에 초점을 맞춰야 합니다
- 패터늘 사용하지 않고 문제를 해결한다고 해서 훌륭한 개발자로 인정을 받지 못하는 건 절대 아닙니다
- 정말 단순하게 잘 만들 수 있다면, 다른 개발자들도 여러분의 능력을 인정하고 존경할 것입니다
- 가장 단순하고 유연한 디자인을 만들 때 패턴이 있어야 한다면 그때 패턴을 적용하면 됩니다

### 디자인 패턴은 만변통치약이 아닙니다

- 패턴은 반복적으로 발생하는 문제의 일반적인 해결책입니다
- 그리고 수많은 개발자가 오랫동안 검증한 해결책이라는 장점도 있지요
- 일단 패턴이 필요하다는 결론을 내리면 다른 개발자들도 비슷한 문제를 겪었고, 비슷한 기법을 적용해서 그 문제를 해결했다고 생각하면 마음이 편해지죠
- 하지만 패턴이 만병통치약은 아닙니다
- 그냥 패턴을 넣고 컴파일한다고 해서 기적같이 문제가 해결되진 않으니까요
- 패턴을 사용할 때는 그 패턴이 여러분이 설계한 디자인에 미칠 영향과 결과를 주의 깊게 생각해 봐야 합니다

### 패턴이 필요할 때

- 디자인을 할 때, 지금 디자인상의 문제에 적합하다는 확신이 든다면 패턴을 도입해야 합니다
- 만약 더 간단한 해결책이 있다면 패턴을 적용하기 전에 그 해결책의 사용을 고려해 봐야 합니다
- 언제 패턴을 적용할지를 올바르게 결정하려면 상당한 경험과 지식이 축척되어야 합니다
- 일단 간단한 해결책만으로 부족하다고 확신을 가지면 해결해야 할 문제와 제약조건을 종합적으로 고려해 봐야합니다
  - 그래야만 그 문제를 해결하는 데 쓸 수 있는 패턴을 정확하게 집어낼 수 있으니까요
- 패턴을 잘 알고 있다면 그 문제를 해결하는 데 쓸 수 있는 패턴을 정확하게 집어낼 수 있으니까요
- 패턴을 잘 알고 있다면 가장 적합한 패턴을 찾을 수 있습니다
- 만약 어떤 패턴을 써야 할지 잘 모르겠다면 문제 해결에 도움이 될 만한 패턴이 있는지 훑어봐야 합니다
- 이런 경우에는 패턴 카탈로그의 용도와 적용 대상 부분을 살펴보면 좋습니다
- 일단 괜찮은 패턴을 찾았다면 결과 부분을 보고 디자인의 나머지 부분에 미치는 영향이 어느정도 인지 확인해 봐야 합니다
- 이 정도까지 했을 때 패턴을 써도 괜찮겠다 싶으면 그 패턴을 적용하면 되죠
- 간단한 해결책으로 문제가 해결되는 데도 시스템의 어떤 부분이 변경될 거라고 예측되는 상황에는 디자인 패턴을 적용해야 합니다
- 지금까지 여러 번 봤듯이, 디자인에서 변경될 수 있는 부분이 있다면 패턴을 적용할 여지가 있습니다
- 하지만 발생 가능성이 높은 실질적인 변경에 대비해서 패턴에 적용해야지, 가능성이 높지 않은 가상적인 변경에 대비해서 패턴을 적용하는 일은 바람직하지 않습니다
- 패턴을 디자인 단계에서만 고려해야 하는 건 아닙니다. 리팩터링 할 때도 패턴 도입을 고려할 수 있습니다

### 리팩터링과 패턴

- 리팩터링이란 코드를 변경해서 코드 구조를 개선하는 과정을 뜻합니다
- 리팩터링의 목적은 행동 변경이 아니라 구조 개선에 있습니다
- 패턴을 사용할면 구조가 더 개선될 수 있을지 검토해 볼 수 있는 아주 좋은 기회라고 할 수 있죠
- 예를 들어 조건 문이 아주 많은 코드가 있다면 상태 패턴의 적용도 고려해 볼 만하겠죠
- 팩토리 패턴을 써서 구상 클래스의 의존성을 말끔하게 정리할 수 있습니다
- 패턴을 이용한 리팩터링을 다루는 책도 많이 나와 있는데, 개발 경력이 쌓이다 보면 아마 이 부분을 더 공부할 필요성을 느끼게 될 것입니다

### 꼭 필요하지 않은 패턴은 빼 버립시다. 지금 있는 디자인에서 디자인 패턴을 제거하는 일을 두려워하지 마세요

- 디자인 패턴을 제거하는 일에 관해서는 거의 들어 본 적이 없죠?
- 하지만 상황에 따라 그래야할 수도 있습니다.
- 언제 패턴을 제거해야 할까요?
- 시스템이 점점 복잡해지면서 처음에 기대했던 유연성이 전혀 발휘되지 못한다면 패턴을 과감하게 제거해 버리는 게 낫습니다
- 즉, 패턴보다 간단한 해결책이 더 나을 것 같다 싶을 때 패턴을 제거하면 됩니다

### 꼭 필요하지 않은 패턴을 미리 적용할 필요는 없습니다

- 디자인 패턴은 강력합니다
- 아름 다운 아키텍처를 만들고 싶은 마음이 들 수 있습니다
- 하지만 이런 유혹을 이겨내야 합니다
- 지금 당장 변화에 대처하는 디자인을 만들어야 한다면 패턴을 적용해서 그 변화에 적응해야 합니다
- 하지만 꼭 필요하지 않은 데도 괜히 패턴을 추가하는 일은 피해야 합니다
- 괜히 시스템만 복잡해지고, 나중에 그 패턴을 사용하지 않을 수도 있으니까요

### 패턴이 아니라 디자인에 집중하세요

- 패턴은 자연스럽게 적용할만한 경우에만 사용하세요
- 더 간단한 해결책이 있다면 그 방법을 쓰는 것이 옳아요

## 스승과 제자

- 꼭 필요할 때만 디자인 패턴을 적용하자
- 지금까지 배운 것은 기본 패턴에 불과하다
  - 실전에서는 컨커런트 시스템이나 엔터프라이즈 시스템 같이 특정 영역에만 적용되는 패턴 등 아직 배우지 못한 패턴도 많이 접하게 될 것입니다
  - 하지만 기초 수련을 잘 했다면 쉽게 배울 수 있습니다

## 패턴을 대하는 마음가짐

### 초보자

- 초보자들은 언제나 패턴을 사용하려는 경향이 있습니다
- 바람직한 일입니다
- 그 과정에서 패턴을 쓰는 연습을 하면서 다양한 경험을 쌓을 수 있으니까요
- 초보자들은 패턴을 많이 쓸수록 더 좋은 디자인이 만들어질 거라고 생각합니다
- 그러다가 어느 순간, 어떤 디자인이든 될 수 있으면 단순하게 만들어야 한다는 사실을 터득하게 되죠
- 확장성이 필요한 경우에만 패턴을 써서 조금 복잡하게 만드는 것이 좋습니다

### 중급자

- 경험이 늘어 중급자 수준에 오르면 어떤 상황에 패턴이 필요하고 필요하지 않은지를 파악할 수 있습니다
- 여전히 잘 맞지 않는 패턴을 억지로 적용하려고 하지만, 그 과정에서 정형적인 패턴이 적합하지 않은 상황에서는 패턴을 적당히 변형해서 써야 한다는 사실을 깨닫게 됩니다

### 그랜드 마스터

- 그랜드 마스터의 경지에 오르면 패턴을 자연스럽게 구사할 수 있습니다
- 더 이상 패턴을 사용하는 일에 얽매이지 않고 문제를 가장 효과적으로 해결하는 방법을 찾는 데 주안점을 둡니다
- 그랜드 마스터들은 객체지향 원칙들을 종합적으로 고려합니다
- 패턴일 필요한 상황이 오면 패턴을 적당히 변형해서 적용합니다
- 그리고 그랜드 마스터들은 유사한 패턴 사이의 관계를 확실히 파악하고 있으며, 관련된 패턴들의 미묘한 차이점을 잘 이해하고 있습니다

### 이제와서 디자인 패턴을 쓰지 말라고요? 물론 디자인 패턴을 써야죠

- 하지만 디자인 패턴을 쓰는 것 못지 않게 훌륭한 객체지향 디자이너가 되는 것도 중요합니다
- 디자인 문제를 해결 -> 검증된 해결책
- 하지만 디자인 패턴을 사용하는 데에도 단점은 있습니다
- 디자인 패턴을 적용하다 보면 디자인이 복잡해지기 마련입니다
- 새로운 계층을 추가해야 할 수도 있는데, 그러면 복잡해지는 문제와 더불어 효율이 떨어지는 문제가 생길 수도 있습니다
- 디자인 패턴을 사용하는 것이 부적절한 경우도 종종 있습니다
- 그냥 디자인 원칙만 충실히 적용해서 훨씬 간단한게 문제를 해결할 수 있는 경우가 많거든요
- 그런 경우에는 괜히 디자인 패턴을 적용하려고 애쓰지 말고 간단한 해결책을 사용합시다
- 낙담하진 마세요. 디자인 패턴을 쓰기에 적합한 상황에서는 수많은 장점을 누릴 수 있으니까요

## 전문 용어의 위력 되새기기

- 간과할 수 없는 사실이 하나 있습니다. 디자인 패턴이 의사소통에 크게 도움이 된다는 점이죠
- 동료 개발자들도 패턴과 전문 용어를 알고 있으면 더 나은 디자인을 만들 수 있고, 서로 더 원활하게 의사소통을 할 수 있습니다

### 용어를 공유하는 5가지 방법

1. 디자인 회의에서 디자인 패턴을 사용하면 '디자인 자체'에 더 많은 시간을 할애할 수 있습니다

- 디자인 패턴과 객체지향 원칙을 바탕으로 토론을 하면 구현과 관련된 자질구레한 내용에 시간을 뺏기지 않아도 되고, 불필요한 오해의 소지도 줄일 수 있습니다

2. 다른 개발자들과 토론할 때 디자인 패턴을 사용해 보세요

- 그러면 다른 개발자들이 새로운 패턴을 배우는 데에도 도움이 되고, 커뮤니티를 구축하는 데도 도움이 됩니다
- 자신이 배운 내용을 다른 사람들과 나눠서 다른 사람을 이해시키는 것만큼 기분 좋은 일도 없죠

3. 아키텍처 문서에 패턴을 활용하면 적은 분량으로 디자인을 분명하게 설명할 수 있습니다
4. 코드 주석을 달 때 어떤 패턴을 사용하고 있는지 적어 주세요

- 그리고 클래스와 메소드 이름을 만들 대도 사용 중인 패턴이 분명하게 드러날 수 있도록 해보세요.
- 다른 개발자들이 그 코드를 볼 때 여러분이 무엇을 어떻게 구현했는지 훨씬 빠르게 이해할 수 있습니다

5. 개발자 모임에서 여러분이 알고 있는 것을 다른 사람들에게도 알려주세요

- 패턴을 들어보긴 했지만 패턴이 무엇인지 잘 모르는 사람들도 많으니까요
- 여러분이 속한 그룹에서 여러분이 알고 있는 것을 친절하게 설명해주세요

## 4인방(Gang of Four)과 함께 하는 객체마을 여행

- 에릭 감마(Erich Gamma)
  - 패턴은 도구지 규칙이 아닙니다
  - 문제에 맞게 적당히 고쳐서 쓸 줄 아는 센스를 가집시다
- 리차드 헬름(Richard Helm)
  - 실질적인 확장성만을 추구합시다
  - 별 근거 없이 일반화하진 마세요
  - 꼭 필요한 부분에만 확장성을 고려합시다
- 랄프 존슨(Ralph Johnson)
  - 너무 오버하지 말고 항상 단순한 해결책을 찾아보세요
  - 패턴을 쓰지 않는 간단한 해결책이 있다면 그 방법을 써야 합니다
- 존 블리시드(John Vlissides)
  - GoF 책에 나와 있는 것 외에도 많은 패턴이 새로 발견되었습니다
  - 그런 패턴들도 공부해 보세요

## 실전! 패턴 동물원 탐방하기

- 건축 패턴(Architectural Pattern)

  - 생동감 있는 건물, 마을, 도시를 만드는 용도로 쓰입니다
  - 패턴이라는 개념은 여기에서 부터 시작되었습니다

- 애플리케이션 패턴(Application Pattern)

  - 시스템 수준의 아키텍처를 만드는 패턴입니다
  - 다양한 다단계 아키텍처가 여기에 속합니다
  - 애플리케이션을 구성하는 컴포넌트들을 어떻게 배치하고 통신할지를 정의합니다
  - MVC, MVP, MVVM 등이 여기에 속합니다

- 특정 영역용 패턴(Domain Specific Pattern)

  - 컨커런트 시스템이라든가 실시간 시스템과 같은 특정 영역에서만 사용되는 패턴입니다
    - 컨커런트(Concurrent : 동시에 발생하는) 시스템
      - 어느 시점을 보았을 때 순간적으로 많은 사용자가 그 서비스를 사용해도(서버에 접근해도) 문제 없이 시스템이 잘 동작해야한다는 것입니다.
      - 이러한 Highly Concurrent 특성은 특히 아이돌 콘서트 티켓 예매와 같은 서비스를 구현할 때 중요합니다. 제한된 좌석을 구매하기 위해 서버에 위험이 될 정도로 수많은 사용자가 서비스를 이용합니다. 이 상황에서도 서버는 죽지 않고 주어진 요청을 잘 공정하게.. 처리해야합니다.(한 좌석에 2명이 예약하면 안 됨)
      - 출처 : https://darkstart.tistory.com/150
  - e.g. 엔터 프라이즈 컴퓨팅

- 비즈니스 프로세스 패턴(Business Process Pattern)

  - 비즈니스, 고객, 데이터 사이의 상호작용을 기술하는 패턴으로, 효과적인 의사소통과 의사 결정 방법을 정할 때 적용할 수 있습니다
  - e.g. 기업 이사실 및 프로젝트 관리 회의 등

- 조직 패턴(Organizational Pattern)

  - 조직의 구조와 운영을 기술하는 패턴입니다
  - 주로 소프트웨어 제작/지원 조직에 초점이 맞춰졌습니다
  - e.g. 개발팀, 고객지원팀

- 사용자 인터페이스 디자인 패턴(User Interface Design Pattern)
  - 사용자들이 직접 다루게 되는 소프트웨어 프로그램을 디자인하는 패턴입니다
  - e.g. 비디오 게임 디자이너, GUI 구축자와 제작자 근방에서 자주 발견 됩니다

## 사악한 안티 패턴 섬멸하기

- 안티 패턴(Anti-Pattern)은 어떤 문제의 나쁜 해결책에 이르는 길을 알려 줍니다

- 안티 패턴은 어떤 이유로 나쁜 해결책에 유혹되는지를 알려줍니다

  - 전혀 매력이 없다면 아무도 나쁜 해결책을 택하진 않겠죠?
  - 안티 패턴의 가장 큰 역할을 나쁜 해결책이 어떤 식으로 사람들을 꼬시는지 설명함으로써 나쁜 패턴을 쓰지 않도록 경고하기에 있습니다

- 안티 패턴은 장기적인 관점에서 그 해결책이 나쁜 이유를 알려줍니다

  - 어떤 해결책이 왜 안티 패턴인지 이해하려면 어떤 부정적인 효과가 나타날지를 알아야 합니다
  - 안티 패턴은 그 해결책을 사용했을 때 어떤 문제가 생길 것인지를 기술합니다

- 안티 패턴은 좋은 해결책을 만들 때 적용할 수 있는 다른 패턴을 제안해 줍니다

  - 진짜 도움이 되는 올바른 방향을 제시해 줘야겠죠
  - 그래서 좋은 해결책으로 이끌어 주는 길잡이를 제공해야 합니다

- 안티 패턴 예시
  - 훌륭한 오픈 소스 대안이 있음에도 기존에 사용하던 내부 캐싱 시스템을 사용하는 웹 기업

## 디자인 도구상자 안에 들어가야 할 도구들

### 객체지향 원칙

- 바뀌는 부분은 캡슐화한다
- 상속보다는 구성을 활용한다
- 구현보다는 인터페이스에 맞춰서 프로그래밍한다
- 상호작용하는 객체 사이에는 가능하면 느슨한 결합을 사용해야 한다
- 클래스는 확장에는 열려 있지만 변경에는 닫혀 있어야 한다(OCP)
- 추상화된 것에 의존하게 만들고 구상 클래스에 의존하지 않게 만든다
- 진짜 절친에게만 이야기 한다
- 먼저 연락하지 마세요. 저희가 연락드리겠습니다
- 어떤 클래스가 바뀌는 이유는 하나뿐이어야만 한다

### 객체 지향 기초

- 추상화
- 캡슐화
- 다형성
- 상속

### 객체지향 패턴

- ...
- 여러분의 패턴 !

## 핵심 정리

- 디자인 패턴을 자연스럽게 적용합시다
  - 패턴은 억지로 적용하면 안 됩니다
- 디자인 패턴은 돌에 새겨진 글씨가 아닙니다
  - 필요에 따라 적당히 변형해서 사용합시다
- 주어진 조건을 만족하는 가장 간단한 해결책을 사용합시다
  - 디자인 패턴을 무조건 써야 하는건 아닙니다
- 디자인 패턴 카탈로그를 읽어보고 패턴을 숙지합시다
  - 패턴사이의 관계도 확실히 이해해야 합니다
- 패턴을 (범주에 따라서) 분류해서 패턴 그룹을 만들 수 있습니다
  - 그룹으로 나누는 것이 패턴 이해에 도움이 된다면 적극적으로 나눠 보세요
- 패턴 작가가 되려면 대단한 노력이 필요합니다
  - 오랜 시간동안 패턴을 다듬어야 합니다
- 여러분이 접할 패턴은 대부분 기존 패턴을 응요한 것입니다
- 주변 사람들과 전문 용어를 공유합시다
  - 공통의 언어로 얘기할 수 있다는 점이 패턴의 가장 큰 장점입니다
- 다른 커뮤니티와 마찬가지로 패턴 커뮤니티에도 그 안에서만 쓰는 용어들이 있습니다
  - 그런 용어들 대문에 주눅 들지 마세요
  - 이 책을 다 읽었다면 아마 대부분 이해할 수 있을 것입니다
