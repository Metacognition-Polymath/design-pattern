# 12. 복합 패턴 - 패턴을 모아 패턴 만들기

## 패턴 섞어 쓰기

- 패턴을 잘 활용하는 방법 가운데 하나는 서로 다른 패턴을 섞어쓰는 것입니다
- 여러 패턴을 함께 사용해서 다양한 디자인 문제를 해결하는 방법을 복합 패턴이라고 부릅니다
- 실전에선 다양한 복합 패턴을 볼 수 있습니다
- 패턴을 몇 개를 결합한다고 해서 무조건 복합 패턴이 되는 것은 아닙니다
- 복합 패턴이라고 불리려면 여러가지 문제의 일반적인 해결법을 제시해야 합니다
- 여러 복합 패턴을 먼저 살펴본 다음, 복합 패턴의 왕이라고 할 수 있는 모델-뷰-컨트롤러(MVC) 패턴을 알아보겠습니다
- 하나의 디자인 문제를 해결하려고 여러 패턴을 함께 사용하는 경우가 종종 있습니다
- 복합 패턴이란 반복적으로 생길 수 있는 일반적인 문제를 해결하는 용도로 2개 이상의 패턴을 결합해서 사용하는 것을 뜻합니다

## 오리 시뮬레이션 게임에 다양한 패턴 적용하기

- 오리 시뮬레이션 게임을 처음부터 다시 만들며서 몇 가지 기능을 추가해 봅시다
- 이 과정에서 하나의 문제를 해결할 때 여러 패턴이 어떻게 공존하고 협력하는지 배울 수 있습니다

### 뇌단련

- 오리를 넣을 수 있는 곳이라면 거위도 넣을 수 있어야 합니다
- 사실 거위들도 소리를 내고 날기도 하고 헤엄도 치는데 시뮬레이션 게임에 넣지 못할 이유가 없죠
- 어떤 패턴을 활용하면 거위와 오리가 잘 어울려 놀 수 있을까요?

### 어댑터 추가하기

- 시뮬레이터는 Quackable 인터페이스를 원하지만, 거위는 quack()이 아닌 honk() 메소드가 들어있습니다

### 꽥꽥학

- 꽥꽥학자들은 오래전 부터 하나의 무리가 몇 번의 꽥꽥 소리를 내는지 연구하고 싶어했습니다
- 오리 클래스는 그대로 두면서 오리가 꽥꽥 소리를 낸 횟수를 세려면 어떤 패턴을 써야 할까요?

### 데코레이터로 감싸기

### 팩토리 메소드

- 오리 객체를 생성하는 작업을 한 군데에서 몰아서 해보자
- 오리를 생성하고 데코레이터로 감싸는 부분을 따로 빼내서 캡슐화해보자

### 추상 팩토리

- 조금 나아지긴 했지만 거위를 만들 때는 여전히 구상 클래스에 의존해서 직접 만들어야 합니다
- 거위를 생성하는 추상 팩토리를 추가해봅시다
- 책에서도 생략 됨

### 오리 무리를 관리하는 기능 - 컴포지트 패턴

- 오리 무리(정확하게 말하자면 Quackable 무리)를 만들어 봅시다
- 객체들로 구성된 컬렉션을 개별 객체와 같은 방식으로 다룰 수 있게 해주는 컴포지트 패턴

### 안전성 vs. 투명성

- 9장에서 컴포지트 패턴을 배웠을 때, 복합 객체(Menu)와 객체(MenuItem)에 똑같은 메소드가 있었습니다.
- 똑같은 메소드를 넣다보니 MenuItem 객체에 사용 되지 않는 add() 메소드도 똑같이 들어있었죠
- 이러면 잎과 복합 객체 사이의 차이점을 투명하게 만들 수 있다는 장점이 있습니다
- 클라이언트는 잎 객체를 다루고 있는지, 아니면 복합 객체를 다루고 있는지를 전혀 신경 쓸 필요가 없죠
- 그냥 무조건 같은 메소드를 호출하면 됩니다
- 여기에서는 복합 객체에서 자식을 관리하는 메소드를 복합 객체에만 넣었습니다
- add() 메소드는 Flock 클래스에만 있죠
- 어차피 오리 객체는 add()에게 아무 쓸모 없는 메소드니까요
- 심지어 아예 오리를 add() 메소드를 호출할 수 없고 오로지 Flock만 호출할 수 있죠
- 이런 디자인은(구성요소에서 어떤 의미도 갖지 못하는 메소드는 아예 호출할 수 없으므로) 더 안전하긴 합니다만,
- 대신 투명성은 떨어집니다
- 클라이언트가 어떤 객체에 Quackable을 추가하려면 그 객체가 Flock인지 아닌지를 확실하게 알고 있어야 하니까요
- 언제나 그렇듯이 객체지향 디자인을 할 때는 장점과 단점을 잘 따져봐야 합니다
- 복합 객체를 만들 때도 상황에 따라서 안정성과 투명성을 적당히 조절해야 합니다
